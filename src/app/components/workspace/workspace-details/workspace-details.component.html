<mat-sidenav-container style="height: 93vh">
  <mat-sidenav mode="side" opened>
    <mat-form-field appearance="fill" style="width: 15vw">
      <mat-label>Search</mat-label>
      <input matInput (keyup)="applyFilter($event)" />
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
    <mat-nav-list>
      <a mat-list-item (click)="openDialog('', '')">
        <mat-icon matListItemIcon>create_new_folder</mat-icon>
        <div matListItemTitle>Add sequence</div>
      </a>
      <a
        mat-list-item
        [routerLink]="'/workspaces/settings'"
        [queryParams]="{ id: workspace ? workspace.id : '' }"
        queryParamsHandling="merge"
      >
        <mat-icon matListItemIcon>settings</mat-icon>
        <div matListItemTitle>Configure</div>
      </a>
    </mat-nav-list>
  </mat-sidenav>
  <mat-sidenav-content>
    <div *ngIf="loading; else content">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
    <ng-template #content>
      <div class="mat-table">
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          matSortDisableClear
          multiTemplateDataRows
        >
          <ng-container matColumnDef="expand">
            <th mat-header-cell *matHeaderCellDef>&nbsp;</th>
            <td mat-cell *matCellDef="let element">
              <button
                mat-icon-button
                (click)="element.expanded = !element.expanded"
              >
                <mat-icon>{{
                  element.expanded ? "keyboard_arrow_up" : "keyboard_arrow_down"
                }}</mat-icon>
              </button>
            </td>
          </ng-container>
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Identifier
            </th>
            <td mat-cell *matCellDef="let element">{{ element.name }}</td>
          </ng-container>
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let element">
              <mat-icon *ngIf="!element.status">question_mark</mat-icon>
              <mat-icon
                style="color: green"
                *ngIf="element.status === 'POSITIVE'"
                >check</mat-icon
              >
              <mat-icon style="color: red" *ngIf="element.status === 'NEGATIVE'"
                >close</mat-icon
              >
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let element">
              <button
                mat-mini-fab
                class="action-button"
                title="Run prediction"
                color="primary"
                (click)="predict(element)"
                [disabled]="predicting || predictionExists(element)"
              >
                <mat-icon style="margin: 0">youtube_searched_for</mat-icon>
              </button>
              <button
                mat-mini-fab
                class="action-button"
                title="Edit"
                color="primary"
                (click)="openDialog(element.name, element.value)"
                [disabled]="predicting"
              >
                <mat-icon style="margin: 0">edit</mat-icon>
              </button>
              <button
                mat-mini-fab
                class="action-button"
                title="Delete"
                color="primary"
                [disabled]="predicting"
              >
                <mat-icon style="margin: 0">delete</mat-icon>
              </button>
            </td>
          </ng-container>

          <ng-container matColumnDef="expandedDetail">
            <td
              mat-cell
              *matCellDef="let element"
              [attr.colspan]="displayedColumns.length"
            >
              <div
                class="element-detail"
                [@detailExpand]="element.expanded ? 'expanded' : 'collapsed'"
              >
                <span class="element-header" style="margin-top: 10px">
                  1--------10--------20--------30--------40
                </span>
                <span
                  class="element-description"
                  [innerHTML]="getColoredRepresentation(element) | noSanitize"
                  style="margin-bottom: 10px"
                >
                </span>
              </div>
            </td>
          </ng-container>
          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: ['expandedDetail']"
            class="detail"
          ></tr>
        </table>
      </div>
      <mat-paginator
        [pageSize]="20"
        [pageSizeOptions]="[5, 10, 20, 50, 100, 200]"
      ></mat-paginator>
    </ng-template>
  </mat-sidenav-content>
</mat-sidenav-container>
